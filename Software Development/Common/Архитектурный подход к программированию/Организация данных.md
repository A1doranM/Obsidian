Организовать структуры данных важнее чем код. Оптимизация алгоритмов ускоряет в разы, а организация данных на порядки.